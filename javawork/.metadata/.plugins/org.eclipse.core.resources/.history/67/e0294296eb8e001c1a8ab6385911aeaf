package day0216;

import java.awt.Color;
import java.awt.Container;
import java.awt.FileDialog;
import java.awt.Font;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.plaf.FontUIResource;

public class Ex03_SwingFileDialog extends JFrame {
  Container cp;
  JTextArea area; // 파일 불러올 곳
  JButton btnOpen, btnSave;// 파일 저장, 파일 열기

  public Ex03_SwingFileDialog(String title) {
    super(title);
    cp = this.getContentPane();
    this.setBounds(100, 100, 400, 400);
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    cp.setBackground(new Color(255, 255, 155));

    setDesign();

    this.setVisible(true);
  }


  public void setDesign() {
    this.setLayout(null);

    btnOpen = new JButton("파일 불러오기");
    btnOpen.setBounds(40, 20, 120, 30);
    this.add(btnOpen);

    btnOpen.addActionListener(new ActionListener() {

      @Override
      public void actionPerformed(ActionEvent e) {
        // TODO Auto-generated method stub
        FileDialog dig = new FileDialog(Ex03_SwingFileDialog.this, "파일열기", FileDialog.LOAD);
        dig.setVisible(true);

        // 선택한 디렉토리
        String dir = dig.getDirectory();
        String file = dig.getFile(); // 선택한 파일명
        System.out.println(dir + "\n" + file);
        if (dir == null) {
          return;
        }

        FileReader fr = null;
        BufferedReader br = null;
        try {
          fr = new FileReader(dir + file);
          br = new BufferedReader(fr);

          // 기존 데이터 삭제 후 불러오기
          area.setText("");

          while (true) {
            String s = br.readLine();

            if (s == null) {
              break;
            }

            area.append(s + "\n");
          }
        } catch (FileNotFoundException e1) {
          // TODO Auto-generated catch block
          e1.printStackTrace();
        } catch (IOException e1) {
          // TODO Auto-generated catch block
          e1.printStackTrace();
        } finally {
          try {
            if (br != null) {
              br.close();
            }
            if (fr != null) {
              fr.close();
            }
          } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
          }
        }
      }
    });
    btnSave = new JButton("파일저장하기");
    btnSave.setBounds(200, 20, 120, 30);
    this.add(btnSave);
    btnSave.addActionListener(new ActionListener() {
      
      @Override
      public void actionPerformed(ActionEvent e) {
        // TODO Auto-generated method stub
        FileDialog dig = new FileDialog(Ex03_SwingFileDialog.this, "파일 저장", FileDialog.SAVE);
        dig.setVisible(true);
      }
    });
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm");
    String day = sdf.format(new Date());
    area = new JTextArea(day);
    area.setFont(new FontUIResource("맑은고딕", Font.BOLD, 20));

    JScrollPane js = new JScrollPane(area);
    js.setBounds(20, 70, 350, 250);
    this.add(js);
  }

  public static void main(String[] args) {
    new Ex03_SwingFileDialog("스윙 파일 저장 2");
  }

}
